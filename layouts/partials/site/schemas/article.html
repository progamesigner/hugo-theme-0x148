{{- $ISO8601 := "2006-01-02T15:04:05-07:00" -}}

<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "{{ .Title }}",
        "description": "{{ with .Description }}{{ . }}{{ else }}{{ if .IsPage }}{{ .Summary }}{{ else }}{{ with .Site.Params.Description }}{{ . }}{{ end }}{{ end }}{{ end }}",
        "wordCount": "{{ .WordCount }}",

        {{ if not .PublishDate.IsZero }}
            "datePublished" : "{{ .PublishDate.Format $ISO8601 | safeHTMLAttr }}",
        {{ end }}

        {{ if not .Lastmod.IsZero }}
            "dateModified" : "{{ .Lastmod.Format $ISO8601 | safeHTMLAttr }}",
        {{ end }}

        {{ if .Params.Images }}
            {{ with first 1 .Params.Images }}
                "image": "{{ . | absURL }}",
            {{ end }}
        {{ end }}

        "keywords": "{{ range $plural, $terms := .Site.Taxonomies }}{{ range $term, $val := $terms }}{{ $term }},{{ end }}{{ end }}",
        "mainEntityOfPage": "{{ .Permalink }}"
    }
</script>
